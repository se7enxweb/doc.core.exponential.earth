
<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<style type="text/css">
    @import url(https://doc.core.exponential.earth/ezno2005/design/ezno2005/stylesheets/core.css);
    @import url(https://doc.core.exponential.earth/ezno2005/design/ezno2005/stylesheets/pagelayout.css);
    @import url(https://doc.core.exponential.earth/ezno2005/design/ezno2005/stylesheets/classes.css);
    @import url(https://doc.core.exponential.earth/ezno2005/design/ezno2005/stylesheets/monitor.css);
</style>

<link type="text/css" rel="stylesheet" href="https://web.archive.org/web/20071224023032cs_/http://ez.no/extension/ezno2005/design/ezno2005/stylesheets/print.css" media="print"/>

    <link rel="alternate" title="ez.no News" href="https://web.archive.org/web/20071224023032/http://ez.no/rss/feed/news" type="application/rss+xml"/><link rel="alternate" title="ez.no Developer News" href="/web/20071224023032/http://ez.no/rss/feed/communitynews" type="application/rss+xml"/>
<link rel="alternate" title="ez.no Developer Articles" href="https://web.archive.org/web/20071224023032/http://ez.no/rss/feed/community_articles" type="application/rss+xml"/>
<link rel="alternate" title="ez.no Forum" href="https://web.archive.org/web/20071224023032/http://ez.no/rss/feed/forum" type="application/rss+xml"/>
<link rel="alternate" title="ez.no Contributions" href="https://web.archive.org/web/20071224023032/http://ez.no/rss/feed/contribs" type="application/rss+xml"/>
<link rel="alternate" title="ez.no Open Funding" href="https://web.archive.org/web/20071224023032/http://ez.no/rss/feed/openfunding_suggestions" type="application/rss+xml"/>


<!-- IE conditional comments; for bug fixes for different IE versions -->
<!--[if IE 5]>     <style type="text/css"> @import url(/extension/ezno2005/design/ezno2005/stylesheets/ie5.css);    </style> <![endif]-->
<!--[if lte IE 6]> <style type="text/css"> @import url(/extension/ezno2005/design/ezno2005/stylesheets/ie6lte.css); </style> <![endif]-->
<!--[if gte IE 6]> <style type="text/css"> @import url(/extension/ezno2005/design/ezno2005/stylesheets/ie6gte.css); </style> <![endif]-->

<!-- Load special stylesheet (if necessary) for newer Netscape decendants, Mozilla and Firefox, using the Gecko renderer -->
<script type="text/javascript"><!-- if ((navigator.userAgent.indexOf("Gecko") != -1)&&(navigator.userAgent.indexOf("KHTML") == -1)) document.write("<style type=\"text/css\">@import url(/extension/ezno2005/design/ezno2005/stylesheets/gecko.css);</style>");--></script>
                                                                    
<title>
            Importing attribute data     /         Development     /         Documentation                    </title>
<meta http-equiv="Content-Language" content="en-GB"/>
    <meta name="author" content="Exponential"/>
    <meta name="copyright" content="Exponential as"/>
    <meta name="description" content="eZ Publish is an open source content management system (CMS) and an open source content management framework (CMF)."/>
    <meta name="keywords" content="cms, publish, e-commerce, content management, development framework"/>

<meta name="MSSmartTagsPreventParsing" content="TRUE"/>
<meta name="generator" content="Exponential"/>

<script type="text/javascript" src="https://doc.core.exponential.earth/ezno2005/design/ezno2005/javascripts/tools.js"></script>
<script type="text/javascript" src="https://doc.core.exponential.earth/ezno2005/design/ezno2005/javascripts/dropdownmenu.js"></script>
</head>    <body onload="menuInit();">

<!-- Complete page area: START -->
<div id="page">

<!-- Header area: START -->
<div id="header">
<div id="header-insert">

<!-- User menu area: START -->
<div id="usermenu">

<div id="page-width1">

<div id="logo">
<h1><a href="https://doc.core.exponential.earth/"><span class="hide">Exponential - The Content Management Ecosystem</span></a></h1>
</div>



<p class="hide"><a href="#main">Skip to main content</a></p>

<hr class="hide"/>
<div id="searchbox">
<form action="/web/20071224023032/http://ez.no/ezsearchredirect/action" method="get">

<div class="block">
<div class="element">
<input id="searchbutton" class="button" type="submit" value="Search"/>
</div>

<div class="element searchstring">
    <label for="searchtext" class="hide">Search text:</label>
    <input id="searchtext" name="SearchText" type="text" size="12"/><br/>
    

            <div class="section">
            <label for="searcharea" class="hide">Search area:</label>
            <select id="searcharea" name="SubTreeArray[]">
                <option value="2" selected="selected">All ez.no</option>
                <option value="306">Bug reports</option>
                <option value="21358">Contributions</option>
                <option value="documentation">Documentation</option>
                <option value="308">Forum</option>
            </select>
            </div>
    </div>

</div>
</form>
</div>

<hr class="hide"/>
<h2 class="hide">User menu</h2>

<!-- User menu content: START -->
<ul>
            <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/download"><span>Downloads</span></a></li>
    <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/company/contact"><span>Contact</span></a></li>
            <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/user/login"><span>Log in</span></a></li>
        <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/user/register"><span>Register</span></a></li>
    
    <li id="language-menu">
        <a class="highlighted" title="English" href="https://web.archive.org/web/20071224023032/http://ez.no/ezpublish/documentation/development/importing_attribute_data"><img src="/ezno2005/design/ezno2005/images/eng-GB.gif" width="18" height="12" alt="English"/></a>
        <a title="Deutsch" href="https://web.archive.org/web/20071224023032/http://ez.no/de/ezpublish/documentation/development/importing_attribute_data"><img src="/ezno2005/design/ezno2005/images/ger-DE.gif" width="18" height="12" alt="Deutsch"/></a>
        <a title="Português" href="https://web.archive.org/web/20071224023032/http://ez.no/br/ezpublish/documentation/development/importing_attribute_data"><img src="/ezno2005/design/ezno2005/images/por-BR.gif" width="18" height="12" alt="Português"/></a>
        <a title="Français" href="https://web.archive.org/web/20071224023032/http://ez.no/fr/ezpublish/documentation/development/importing_attribute_data"><img src="/ezno2005/design/ezno2005/images/fre-FR.gif" width="18" height="12" alt="Français"/></a>
        <a title="日本語" href="https://web.archive.org/web/20071224023032/http://ez.no/jp/ezpublish/documentation/development/importing_attribute_data"><img src="/ezno2005/design/ezno2005/images/jpn-JP.gif" width="18" height="12" alt="日本語"/></a>        
        <a title="中文" href="https://web.archive.org/web/20071224023032/http://ez.no/tw/ezpublish/documentation/development/importing_attribute_data"><img src="/ezno2005/design/ezno2005/images/chi-TW.gif" width="18" height="12" alt="中文"/></a>        
        <a title="Norsk" href="https://web.archive.org/web/20071224023032/http://ez.no/no/ezpublish/documentation/development/importing_attribute_data"><img src="/ezno2005/design/ezno2005/images/nor-NO.gif" width="18" height="12" alt="Norsk"/></a>        
    </li>
</ul>
<!-- User menu content: END -->

</div>

</div>
<!-- User menu area: END -->

</div>
</div>
<!-- Header area: END --><script type="text/javascript">
<!--
var menu = new Array();


-->
</script>
<div id="menuborder">

<!-- Main menu area: START -->
<div id="menu" onmouseover="menuHover();" onmouseout="tryHideSubMenues();">

<div id="mainmenu" class="float-break">
<div id="page-width2">
    <ul id="mainmenulist" class="float-break">
<li class="current"><a href="https://web.archive.org/web/20071224023032/http://ez.no/products" onmouseover="switchSubMenu( this );">Products &amp; services</a></li>
<li><a href="https://web.archive.org/web/20071224023032/http://ez.no/education" onmouseover="switchSubMenu( this );">Education</a></li>
<li><a href="https://web.archive.org/web/20071224023032/http://ez.no/customers" onmouseover="switchSubMenu( this );">Customers</a></li>
<li><a href="https://web.archive.org/web/20071224023032/http://ez.no/partner" onmouseover="switchSubMenu( this );">Partners</a></li>
<li><a href="https://web.archive.org/web/20071224023032/http://ez.no/developer" onmouseover="switchSubMenu( this );">Developer</a></li>
<li><a href="https://web.archive.org/web/20071224023032/http://ez.no/support" onmouseover="switchSubMenu( this );">Support</a></li>
<li><a href="https://web.archive.org/web/20071224023032/http://ez.no/store" onmouseover="switchSubMenu( this );">Store</a></li>
<li class="last"><a href="https://web.archive.org/web/20071224023032/http://ez.no/company" onmouseover="switchSubMenu( this );">Company</a></li>
</ul>

</div>
</div>


<div id="submenu">
<div id="page-width3">
    <ul class="float-break">
                        <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/ezpublish">eZ Publish</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/ezpublish/premium">eZ Publish Premium</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/ezpublish/now">eZ Publish Now</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/ezpublish/on_demand">eZ Publish On Demand</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/products/proprietary_license_options">Proprietary license options</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/products/certified_extensions">Certified extensions</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/ezflow">eZ Flow</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/ezcomponents">eZ Components</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/ezfind">eZ Find</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/eznewsletter">eZ Newsletter</a></li>
                                <li><a href="https://web.archive.org/web/20071224023032/http://ez.no/products/expert_consulting_services">Expert consulting services</a></li>
                                <li class="last"><a href="https://web.archive.org/web/20071224023032/http://ez.no/products/support">Support</a></li>
                </ul>
</div>
</div>

<script type="text/javascript"><!--
    document.getElementById('submenu').style.display = 'none';
--></script>

</div>
<!-- Main menu area: END -->

</div>

<hr class="hide"/><!-- Path area: START -->
<div id="path">

<div id="page-width4">
<h2 class="hide">Path</h2>

<!-- Path content: START -->
<p>
                        <a href="https://web.archive.org/web/20071224023032/http://ez.no/">ez.no</a>
        
                        /
                            <a href="https://web.archive.org/web/20071224023032/http://ez.no/ezpublish">ezpublish</a>
        
                        /
                            <a href="toc.html">documentation</a>
        
                        /
                            <a href="development.html">development</a>
        
                        /
                            importing attribute data
        
            </p>
<!-- Path content: END -->

</div>

</div>
<!-- Path area: END -->

<hr class="hide"/>

<!-- Main area: START -->

<div id="page-width5">
<div id="main" class="float-break">

<!-- Main area content: START -->




<div class="template-design area-main-normal">
<div class="template-module content-view-full">
<div class="template-object class-documentation">


<div class="attribute-heading">
    <h1>Importing attribute data</h1>
</div>

<p><strong>These documentation pages are no longer maintained. Please visit the <a href="https://exponential.doc.exponential.earth">new documentation site.</a></strong></p>

<div class="attribute-long">
    

<a name="eztoc87217_1" id="eztoc87217_1"></a><h2>Importing attribute data</h2>
<p>
If the datatype is not plain text or a number, importing data into eZ publish is a bit more complicated. The code below gives routines to import complex data, in this case Enum's and xmltext, and a general function to import most datatypes.
</p>

<p>

The problem is that the kernel code is not consistent in importing data. Each datatype has a function storeObjectAttribute(), but in most cases it does not do anything, and the actual storing is done in a different function. Also, often<br/>the values to be stored are extracted from the http post variables.
</p>

<p>

In the forums, reference has been already to an example file to importing simple data into eZ publish:<br/><a href="https://web.archive.org/web/20071224023032/http://ez.no/">http://zev.ez.no/svn/nextgen/trunk/scrap/testimport.php</a>
</p>

<a name="eztoc87217_1_1" id="eztoc87217_1_1"></a><h3>Enum</h3>
<p>
The following routine can import Enumerated datatype. The selected values are stored in an array $array_selectedEnumElement, as an Enum may contain only a single or multiple values.
</p>
    <pre class="wordwrap"><span class="line">include_once( 'kernel/classes/datatypes/ezenum/ezenumtype.php' ); </span>

<span class="line">&nbsp;</span>

<span class="line">function store_enum( $array_selectedEnumElement, &amp;$contentObjectAttribute )</span>

<span class="line">{</span>

<span class="line">&nbsp;&nbsp;&nbsp;// Adapted from function fetchObjectAttributeHTTPInput(...) in class eZEnumType;</span>

<span class="line">&nbsp;&nbsp;&nbsp;$contentObjectAttributeID = $contentObjectAttribute-&gt;attribute( 'id' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;$contentObjectAttributeVersion = $contentObjectAttribute-&gt;attribute( 'version' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;$contentClassAttribute = $contentObjectAttribute-&gt;attribute( 'contentclass_attribute' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;$contentClassAttributeID = $contentClassAttribute-&gt;attribute('id' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;$contentClassAttributeVersion = $contentClassAttribute-&gt;attribute('version' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;$array_enumValue = ezEnumValue::fetchAllElements( $contentClassAttributeID, </span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentClassAttributeVersion );</span>

<span class="line">&nbsp;&nbsp;&nbsp;eZEnum::removeObjectEnumerations( $contentObjectAttributeID, $contentObjectAttributeVersion );</span>

<span class="line">&nbsp;&nbsp;&nbsp;foreach( $array_enumValue as $enumValue ) </span>

<span class="line">&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach( $array_selectedEnumElement as $selectedEnumElement ) </span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( $enumValue-&gt;EnumElement === $selectedEnumElement ) </span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eZEnum::storeObjectEnumeration( $contentObjectAttributeID, </span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttributeVersion, $enumValue-&gt;ID, </span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$enumValue-&gt;EnumElement, $enumValue-&gt;EnumValue );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;}</span>

<span class="line">}</span></pre>
    
<a name="eztoc87217_1_2" id="eztoc87217_1_2"></a><h3>Xmltext</h3>
<p>
The following class takes a text (with some HTML formatting, e.g., bold, italics, lists, tables, and links) to xmldata and stores it in the attribute. See the general function for importing any datatype below on how to use it.
</p>
    <pre class="wordwrap"><span class="line">include_once( 'kernel/classes/datatypes/ezxmltext/handlers/input/ezsimplifiedxmlinput.php' );</span>

<span class="line">&nbsp;</span>

<span class="line">class text2xml extends eZSimplifiedXMLInput</span>

<span class="line">{</span>

<span class="line">&nbsp;&nbsp;&nbsp;function text2xml( &amp;$xmlData, $contentObjectAttribute )</span>

<span class="line">&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;eZSimplifiedXMLInput( $xmlData, 0, $contentObjectAttribute );</span>

<span class="line">&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;function &amp;validateText( &amp;$data, &amp;$contentObjectAttribute )</span>

<span class="line">&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttributeID = $contentObjectAttribute-&gt;attribute( &quot;id&quot; );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Below is same as in the function validateInput(...) in class eZSimplifiedXMLInput</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eZDebug::writeDebug($data, &quot;input data&quot;);</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Set original input to a global variable</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$originalInput = &quot;originalInput_&quot; . $contentObjectAttributeID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$GLOBALS[$originalInput] = $data;</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Set input valid true to a global variable</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$isInputValid = &quot;isInputValid_&quot; . $contentObjectAttributeID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$GLOBALS[$isInputValid] = true;</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inputData = &quot;&lt;section xmlns:image='http://ez.no/namespaces/ezpublish3/image/' </span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlns:xhtml='http://ez.no/namespaces/ezpublish3/xhtml/' &gt;&quot;;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inputData .= &quot;&lt;paragraph&gt;&quot;;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inputData .= $data;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inputData .= &quot;&lt;/paragraph&gt;&quot;;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$inputData .= &quot;&lt;/section&gt;&quot;;</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data =&amp; $this-&gt;convertInput( $inputData );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message = $data[1];</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $this-&gt;IsInputValid == false )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$GLOBALS[$isInputValid] = false;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$errorMessage = null;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ( $message as $line )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$errorMessage .= $line .&quot;;&quot;;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;setValidationError( ezi18n( 'kernel/classes/datatypes',</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$errorMessage,</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'ezXMLTextType' ) );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_INVALID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dom = $data[0];</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objects =&amp; $dom-&gt;elementsByName( 'object' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $objects !== null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ( array_keys( $objects ) as $objectKey )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object =&amp; $objects[$objectKey];</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objectID = $object-&gt;attributeValue( 'id' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$currentObject =&amp; eZContentObject::fetch( $objectID );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$editVersion = $contentObjectAttribute-&gt;attribute('version');</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$editObjectID = $contentObjectAttribute-&gt;attribute('contentobject_id');</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$editObject =&amp; eZContentObject::fetch( $editObjectID );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $currentObject == null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$GLOBALS[$isInputValid] = false;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;setValidationError( ezi18n( 'kernel/classes/datatypes',</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Object '. $objectID .' does not exist.', 'ezXMLTextType' ) );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_INVALID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$relatedObjects =&amp; $editObject-&gt;relatedContentObjectArray( $editVersion );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$relatedObjectIDArray = array();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ( $relatedObjects as $relatedObject )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$relatedObjectID = $relatedObject-&gt;attribute( 'id' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$relatedObjectIDArray[] = $relatedObjectID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( !in_array( $objectID, $relatedObjectIDArray ) )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$editObject-&gt;addContentObjectRelation( $objectID, $editVersion );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// If there are any image object with links.</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$href = $object-&gt;attributeValueNS( 'ezurl_href',</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'http://ez.no/namespaces/ezpublish3/image/' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$urlID = $object-&gt;attributeValueNS( 'ezurl_id', </span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'http://ez.no/namespaces/ezpublish3/image/' );</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $href != null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$linkID =&amp; eZURL::registerURL( $href );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;appendAttribute( $dom-&gt;createAttributeNodeNS(</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'http://ez.no/namespaces/ezpublish3/image/', 'image:ezurl_id', $linkID ) );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$object-&gt;removeNamedAttribute( 'ezurl_href' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $urlID != null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url =&amp; eZURL::url( $urlID );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $url == null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$GLOBALS[$isInputValid] = false;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;setValidationError( ezi18n( 'kernel/classes/datatypes',</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Link '. $urlID .' does not exist.', 'ezXMLTextType' ) );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_INVALID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$links =&amp; $dom-&gt;elementsByName( 'link' );</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $links !== null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ( array_keys( $links ) as $linkKey )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$link =&amp; $links[$linkKey];</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $link-&gt;attributeValue( 'id' ) != null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$linkID = $link-&gt;attributeValue( 'id' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url =&amp; eZURL::url( $linkID );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $url == null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$GLOBALS[$isInputValid] = false;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;setValidationError( ezi18n( 'kernel/classes/datatypes',</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Link '. $linkID .' does not exist.', 'ezXMLTextType' ) );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_INVALID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $link-&gt;attributeValue( 'href' ) != null )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url = $link-&gt;attributeValue( 'href' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$linkID =&amp; eZURL::registerURL( $url );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$link-&gt;appendAttribute( $dom-&gt;createAttributeNode( 'id', $linkID ) );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$link-&gt;removeNamedAttribute( 'href' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$domString = $dom-&gt;toString();</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;eZDebug::writeDebug($domString, &quot;unprocessed xml&quot;);</span>

<span class="line">&nbsp;&nbsp;$domString = preg_replace( &quot;#&lt;paragraph&gt; &lt;/paragraph&gt;#&quot;, &quot;&lt;paragraph&gt; &lt;/paragraph&gt;&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;$domString = str_replace ( &quot;&lt;paragraph /&gt;&quot; , &quot;&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;$domString = str_replace ( &quot;&lt;line /&gt;&quot; , &quot;&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;$domString = str_replace ( &quot;&lt;paragraph&gt;&lt;/paragraph&gt;&quot; , &quot;&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;//$domString = preg_replace( &quot;#&gt;[W]+&lt;#&quot;, &quot;&gt;&lt;&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;$domString = preg_replace( &quot;#&lt;paragraph&gt; &lt;/paragraph&gt;#&quot;, &quot;&lt;paragraph /&gt;&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;$domString = preg_replace( &quot;#&lt;paragraph&gt;&lt;/paragraph&gt;#&quot;, &quot;&quot;, $domString );</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;$domString = preg_replace( &quot;#[</span>

<span class="line">]+#&quot;, &quot;&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;$domString = preg_replace( &quot;#&lt;/LINE&gt;#&quot;, &quot;</span>

<span class="line">&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;$domString = preg_replace( &quot;#&lt;PARAGRAPH&gt;#&quot;, &quot;</span>

<span class="line">&nbsp;</span>

<span class="line">&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;eZDebug::writeDebug($domString, &quot;domstring&quot;);</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$xml = new eZXML();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tmpDom =&amp; $xml-&gt;domTree( $domString, array( 'CharsetConversion' =&gt; false ) );</span>

<span class="line">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$domString = $tmpDom-&gt;toString();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$domString = eZXMLTextType::domString( $tmpDom );</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eZDebug::writeDebug($domString, &quot;stored xml&quot;);</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;setAttribute( &quot;data_text&quot;, $domString );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;setValidationLog( $message );</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$paragraphs = $tmpDom-&gt;elementsByName( 'paragraph' );</span>

<span class="line">&nbsp;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$classAttribute =&amp; $contentObjectAttribute-&gt;contentClassAttribute();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $classAttribute-&gt;attribute( &quot;is_required&quot; ) == true )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( count( $paragraphs ) == 0 )</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_INVALID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_ACCEPTED;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_ACCEPTED;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EZ_INPUT_VALIDATOR_STATE_INVALID;</span>

<span class="line">&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;</span>

<span class="line">}</span></pre>
    
<a name="eztoc87217_1_3" id="eztoc87217_1_3"></a><h3>General data import</h3>
<p>
This function will import most datatypes and stores the value in the objectContentAttribute.
</p>
    <pre class="wordwrap"><span class="line">function store_attr( $data, &amp;$contentObjectAttribute )</span>

<span class="line">{</span>

<span class="line">&nbsp;&nbsp;&nbsp;$contentClassAttribute = $contentObjectAttribute-&gt;attribute( 'contentclass_attribute' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;$dataTypeString = $contentClassAttribute-&gt;attribute( 'data_type_string' );</span>

<span class="line">&nbsp;&nbsp;&nbsp;switch( $dataTypeString ) {</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezfloat' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezprice' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;SetAttribute( 'data_float', $data );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;store();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezboolean' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezdate' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezdatetime' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezinteger' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezsubtreesubscription' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'eztime' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;SetAttribute( 'data_int', $data );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;store();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezemail' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezisbn' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezstring' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'eztext' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezurl' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;SetAttribute( 'data_text', $data );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;store();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezxmltext' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dummy = &quot;&quot;;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$converter = new text2xml( $dummy, 0, $contentObjectAttribute );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$converter-&gt;validateText( $data, $contentObjectAttribute );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;SetAttribute( 'data_int', EZ_XMLTEXT_VERSION_TIMESTAMP );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$contentObjectAttribute-&gt;store();</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'ezenum' :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( is_array( $data )) {</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store_enum( $data, $contentObjectAttribute );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;store_enum( array( $data ), $contentObjectAttribute );</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default :</span>

<span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die( 'Can not store this datatype: ' . $dataTypeString );</span>

<span class="line">&nbsp;&nbsp;&nbsp;}</span>

<span class="line">}</span></pre>
    </div>


<div class="content-view-children">
<div class="class-comment">
    <h1 id="comments">Comments</h1>    <div class="block float-break">
              <form method="post" action="/web/20071224023032/http://ez.no/content/action">
             <input class="button" type="submit" name="NewButton" value="New comment"/>
             <input type="hidden" name="RedirectURIAfterPublish" value="ezpublish/documentation/development/importing_attribute_data#comments"/>
             <input type="hidden" name="NodeID" value="31560"/>
                             <input type="hidden" name="ClassIdentifier" value="article_comment"/>
                          <input type="hidden" name="ContentLanguageCode" value="eng-GB"/>
         </form>
         </div>


        

<div class="content-view-line">
<div class="class-comment bglight">

    
    <div id="msg77297" class="attribute-heading">
        <h2>eZURL update for 3.6</h2>
    </div>

<div class="attribute-byline float-break">
    <p class="author">Antoine W.</p>
    <p class="date">Tuesday 14 June 2005 6:13:48 pm</p>
</div>


<div class="attribute-short">
            To have this code working for 3.6, I had to replace:<br/>
   $link-&gt;appendAttribute( $dom-&gt;createAttributeNode( 'id', $linkID ) );<br/>
with:<br/>
   $link-&gt;appendAttribute( $dom-&gt;createAttributeNode( 'url_id', $linkID ) );<br/>
<br/>
Now, links are well stored in &quot;ezurl&quot; table, but dont appear in &quot;URL management&quot; of admin access. Any idea ?

    </div>


</div>
</div>
    

<div class="content-view-line">
<div class="class-comment bgdark">

    
    <div id="msg62201" class="attribute-heading">
        <h2>ObjectRelation atrribute ?</h2>
    </div>

<div class="attribute-byline float-break">
    <p class="author">Lazaro Ferreira</p>
    <p class="date">Wednesday 03 November 2004 6:56:20 pm</p>
</div>


<div class="attribute-short">
            The function doesn't include objectrelation attribute, how to import it ?<br/>
<br/>
Thanks

    </div>


</div>
</div>
    

<div class="content-view-line">
<div class="class-comment bglight">

    
    <div id="msg57885" class="attribute-heading">
        <h2>Addition to 'ezurl'</h2>
    </div>

<div class="attribute-byline float-break">
    <p class="author">Silke Fox</p>
    <p class="date">Monday 30 August 2004 8:36:26 am</p>
</div>


<div class="attribute-short">
            To store ezurl attributes correctly, you should extend the function store_attr like this:<br/>
<br/>
....<br/>
case &quot;ezurl&quot;:<br/>
  $urlID =&amp; eZURL::registerURL( $attributeValue );<br/>
  $attribute-&gt;setAttribute( 'data_text', $attributeValue );<br/>
  // store ezurl id in data_int<br/>
  if( is_int( $urlID ) )<br/>
	$attribute-&gt;setAttribute( 'data_int', $urlID );<br/>
  $attribute-&gt;store();<br/>
  break;<br/>
....<br/>
<br/>
eZURL::registerURL checks if the URL already exists in the ezurl db table, if not, it is created. <br/>
It returns the URL id, which is stored in the attribute data_int value as reference. <br/>
URL validation is still missing here, I guess.

    </div>


</div>
</div>
    

<div class="content-view-line">
<div class="class-comment bgdark">

    
    <div id="msg32118" class="attribute-heading">
        <h2>Text conversion</h2>
    </div>

<div class="attribute-byline float-break">
    <p class="author">Harry Oosterveen</p>
    <p class="date">Tuesday 12 August 2003 2:57:43 pm</p>
</div>


<div class="attribute-short">
            Thanks for the feedback. I used it to convert paragraphs of text (say, the main text of articles) that were stored in a database. These were not complete pages, so only elements like bold, italics, and links were used. I did some testing and found out that tables are also converted properly. To create paragraphs, you have to separate them with empty lines. <br/>
<br/>
I have changed the class name html2xml to text2xml, which is less misguiding, I hope.

    </div>


</div>
</div>
    

<div class="content-view-line">
<div class="class-comment bglight">

    
    <div id="msg31603" class="attribute-heading">
        <h2>Huh ?</h2>
    </div>

<div class="attribute-byline float-break">
    <p class="author">Esben Maaløe</p>
    <p class="date">Sunday 03 August 2003 3:35:28 pm</p>
</div>


<div class="attribute-short">
            &gt; The following class takes a text with HTML formatting (e.g., a page from a previous webpage that you want to convert to eZ Publish) to xmldata and stores<br/>
<br/>
I misunderstood this completely - I thought this class was about converting HTML to eZPub XML - but it is not (the name 'html2xml' is probably a bit misguiding ).<br/>
<br/>
--<br/>
<br/>
$data =&amp; $this-&gt;convertInput( $inputData ); <br/>
--<br/>
<br/>
This is the exact same thing as would happen if you did a copy/paste job into a XML-text form-field.<br/>
<br/>
Could you expand your page with an example on HOW you are using this? <br/>
<br/>
I am probably being thick as a brick - but this function will fail if you put avg. HTML into it. It will not convert H1, P, BR etc.. tags. It will not deal with the contents of a HEAD tag etc.. etc... In short - it may store the DATA that you give it provided it is wellformed (or almost wellformed) to begin with - but it will NOT convert html to xml.<br/>
<br/>
Sorry for being a thicko :D Plz help me understand this thing.... what is it for ?

    </div>


</div>
</div>


 


</div>
</div>

<div class="block float-break">
            <form method="post" action="/web/20071224023032/http://ez.no/content/action">
            <input class="button" type="submit" name="NewButton" value="New comment"/>
            <input type="hidden" name="RedirectURIAfterPublish" value="ezpublish/documentation/development/importing_attribute_data#comments"/>
            <input type="hidden" name="NodeID" value="31560"/>
                           <input type="hidden" name="ClassIdentifier" value="article_comment"/>
                        <input type="hidden" name="ContentLanguageCode" value="eng-GB"/>
        </form>
    </div>

</div>
</div>
</div>


<div class="template-design area-sidebar-normal">
<div class="template-module content-view-sidebar">
<div class="template-object class-documentation">

<div class="attribute-heading">
    <h2 class="bullet">Contents</h2>
</div>
<h3><a href="development.html">Development</a></h3>
<p>
        
        
            
                    <a href="development/extensions.html">Extensions</a><br/>
          
	
            
                    <a href="development/ez_publish_datamodel.html">eZ publish datamodel</a><br/>
          
	
            
                    <a href="development/ez_publish_tuning_and_stability.html">eZ publish tuning and stability</a><br/>
          
	
            
                    <a href="development/importing_attribute_data.html"><b>Importing attribute data</b></a><br/>
          
	
            
                    <a href="development/kernel.html">Kernel</a><br/>
          
	
            
                    <a href="development/libraries.html">Libraries</a><br/>
          
	
            
                    <a href="development/scripting.html">Scripting</a><br/>
          
	
            
                    <a href="development/standards.html">Standards</a><br/>
          
	
            
                    <a href="development/system_overview.html">System overview</a><br/>
          
	
            
                    <a href="development/test_suite.html">Test Suite</a><br/>
          
	
            
                    <a href="development/using_doxygen_to_create_api_documentation.html">Using Doxygen to create API documenta...</a><br/>
          
	
        </p>


<hr class="docsplit"/>
<h3>Created</h3>
<p>
01/08/2003<br/>
11:44:47 pm<br/>
by Harry Oosterveen
</p>
<h3>Last updated</h3>
<p>
12/08/2003<br/>
3:27:18 pm<br/>
by Harry Oosterveen
</p>
<h3>Authors</h3>
<p class="rendered">Harry Oosterveen<br/></p>

<br/>
<hr class="docsplit"/>

<p>This page is part of the eZ Publish documentation. The documentation is available under the <a href="https://web.archive.org/web/20071224023032/http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License.</a> All contributions will be released under the terms of this license.</p>

</div>
</div>
</div>





<!-- Main area content: END -->

</div>
</div>

<!-- Main area: END -->

<hr class="hide"/>

<!-- Footer area: START -->
<div id="footer-design">
<div id="page-width6">
<div id="footer">

<address>Powered by eZ Publish&reg; Content Management System.<br/>
Copyright &copy;1999 - 2025 7x and 2007 Exponential (except where otherwise noted). All rights reserved.</address>

</div>
</div>
</div>
<!-- Footer area: END -->

</div>
<!-- Complete page area: END -->


    

</body>
</html>

<!-- th[eZ] 20050804 --><!--
     FILE ARCHIVED ON 02:30:32 Dec 24, 2007 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 11:20:28 Oct 31, 2024.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.479
  exclusion.robots: 0.019
  exclusion.robots.policy: 0.008
  esindex: 0.009
  cdx.remote: 4.361
  LoadShardBlock: 61.671 (3)
  PetaboxLoader3.datanode: 74.645 (4)
  load_resource: 133.785
  PetaboxLoader3.resolve: 51.784
-->